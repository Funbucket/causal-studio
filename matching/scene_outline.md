# Matching Estimator - Scene 구조 설계

## A) 전체 영상의 한 줄 요약

**단순 비교의 함정에서 시작해, 회귀와 매칭이 각각 어떻게 교란을 통제하는지 보여주고, 두 방법의 trade-off를 드러낸다.**

---

## B) Scene 구조 목록

### Scene 01: paradox_of_comparison
**핵심 주장**: 단순 평균 비교는 인과효과가 아니라 편향된 결과를 보여준다

**Expected Misconception**: 처리군과 대조군의 평균 차이가 곧 인과효과다

**Visual Pivot**: 처리군이 오히려 나빠 보이는 역설적 결과 → "약이 해롭다?"라는 질문

**Beats**:
1. 약물 예시 데이터 등장 (남성 6명, 여성 4명)
2. 단순 평균 비교: treated vs control → -1.19
3. "약이 해롭다?"라는 질문 제기

---

### Scene 02: confounding_revealed
**핵심 주장**: 제3의 변수(교란)가 처리와 결과 모두에 영향을 주면 단순 비교는 편향된다

**Expected Misconception**: 데이터가 충분하면 단순 비교로도 진짜 효과를 알 수 있다

**Visual Pivot**: 진짜 효과(남성 -3, 여성 -2)가 등장하며 방향이 뒤집힘

**Beats**:
1. 셀별 진짜 효과 공개: 남성 -3, 여성 -2
2. 진짜 ATE = -2.6 계산
3. "Confounding" 라벨과 함께 성별→처리 화살표 강조

---

### Scene 03: regression_partitions
**핵심 주장**: 회귀분석은 데이터를 공변량 셀로 분할하여 각 셀 내에서 효과를 추정한다

**Expected Misconception**: 회귀는 마법처럼 교란을 제거한다 (내부 작동 원리 불명확)

**Visual Pivot**: 하나의 테이블이 두 개의 셀(남/여)로 시각적으로 분리됨

**Beats**:
1. 데이터가 남성/여성 두 그룹으로 분리되는 애니메이션
2. 각 셀 내에서 treated vs control 비교
3. 셀별 효과 등장: 남성 -3, 여성 -2

---

### Scene 04: variance_weighting
**핵심 주장**: 회귀는 단순 평균이 아닌 "처리 분산" 비례 가중치로 셀별 효과를 결합한다

**Expected Misconception**: 회귀는 셀별 효과를 표본 크기로 평균낸다

**Visual Pivot**: 분산 수치(0.139 vs 0.25)가 등장하고 회귀 계수가 여성 쪽으로 끌림

**Beats**:
1. 분산 가중치 개념 도입
2. 남성 Var(T) = 0.139, 여성 Var(T) = 0.25 표시
3. 최종 계수 -2.57이 여성 효과(-2)에 더 가까움

---

### Scene 05: subclassification_formula
**핵심 주장**: 층화 추정량은 셀별 효과를 "표본 크기" 비례로 가중평균한다

**Expected Misconception**: 회귀와 층화 추정량은 같은 결과를 낸다

**Visual Pivot**: 수식이 적분 → 이산합으로 Transform되며 가중치 차이 명시

**Beats**:
1. ATE 적분 공식 등장
2. 이산화: 셀별 합으로 변환
3. 결과 -2.6 (회귀의 -2.57과 다름)
4. "특성이 많아지면?" 질문 제기

---

### Scene 06: matching_intuition
**핵심 주장**: 매칭은 각 처리 단위에 유사한 대조 단위("쌍둥이")를 찾아 비교한다

**Expected Misconception**: 셀을 나누는 것과 매칭은 같은 방법이다

**Visual Pivot**: 개별 단위 사이에 연결선이 그려지며 "쌍 찾기" 직관 전달

**Beats**:
1. 연수생 데이터: 단순 비교 → -4297 (연수가 해롭다?)
2. 연수생이 더 젊다는 사실 드러남
3. 나이로 매칭: 연결선 애니메이션
4. 매칭 후 효과 → +2458 (방향 반전)

---

### Scene 07: knn_matching
**핵심 주장**: 다변량 매칭은 스케일링된 특성 공간에서 최근접 이웃을 찾는다

**Expected Misconception**: 특성이 많을수록 매칭이 더 정확해진다

**Visual Pivot**: 2D 산점도에서 각 treated → nearest control로 선이 연결됨

**Beats**:
1. 다변량 데이터 산점도 등장
2. 스케일링의 중요성: 단위가 다르면 거리가 왜곡됨
3. KNN 매칭 시각화: 연결선
4. 매칭 추정량 공식 등장

---

### Scene 08: matching_bias
**핵심 주장**: 불완전 매칭은 체계적 편향을 만들며, 회귀로 보정할 수 있다

**Expected Misconception**: 매칭만 하면 편향이 사라진다

**Visual Pivot**: 보정 전(-0.995) vs 보정 후(-7.36) 숫자가 극적으로 변함

**Beats**:
1. 매칭된 쌍 사이 거리 ≠ 0 → X_i ≈ X_j
2. 편향 공식 등장
3. 회귀 보정 공식으로 Transform
4. 결과 비교: 보정의 효과 시각화

---

### Scene 09: curse_of_dimensionality
**핵심 주장**: 차원이 증가하면 데이터 공간이 기하급수적으로 희소해진다

**Expected Misconception**: 특성을 많이 통제할수록 좋다

**Visual Pivot**: 1D → 2D → 10D로 셀 수가 폭발하는 애니메이션

**Beats**:
1. 1D: 5개 셀
2. 2D: 25개 셀 (격자)
3. 10D: 59,049개 셀 (숫자 폭발)
4. "데이터가 희소해진다" → 매칭이 어려워짐

---

### Scene 10: regression_vs_matching
**핵심 주장**: 회귀와 매칭은 각각 장단점이 있으며 맥락에 따라 선택해야 한다

**Expected Misconception**: 하나의 방법이 항상 우월하다

**Visual Pivot**: 두 방법의 특성이 병렬로 나열되며 trade-off 구조 드러남

**Beats**:
1. 회귀: 모수적, 분산 가중, 차원 축소
2. 매칭: 비모수적, 유연, 지역적
3. 공통점: 둘 다 편향 보정 필요
4. 결론: 맥락에 맞는 도구 선택

---

## C) Scene 간 연결 구조

### Scene 01 → 02: 역설에서 해명으로
- 긴장: "약이 해로운가?"
- 해소: 진짜 효과는 반대 방향

### Scene 02 → 03: 문제 인식에서 해결책으로
- 긴장: "교란을 어떻게 통제하나?"
- 전환: 회귀의 내부 작동 원리 도입

### Scene 03 → 04: 분할에서 결합으로
- 긴장: "셀별 효과를 어떻게 합치나?"
- 전환: 가중치 개념 도입

### Scene 04 → 05: 회귀에서 대안으로
- 긴장: "분산 가중치가 최선인가?"
- 전환: 표본 크기 가중치(층화 추정량) 소개

### Scene 05 → 06: 셀 기반에서 개별 기반으로
- 긴장: "특성이 많아지면 셀이 빈다"
- 전환: 셀 대신 개별 매칭 아이디어

### Scene 06 → 07: 직관에서 구현으로
- 긴장: "다변량에서 어떻게 매칭하나?"
- 전환: KNN과 거리 측정 도입

### Scene 07 → 08: 구현에서 한계로
- 긴장: "매칭이 완벽하지 않다면?"
- 전환: 편향 문제와 보정 필요성

### Scene 08 → 09: 보정에서 근본 한계로
- 긴장: "특성을 더 넣으면 되지 않나?"
- 전환: 차원의 저주 소개

### Scene 09 → 10: 문제에서 종합으로
- 긴장: "그럼 어떤 방법을 써야 하나?"
- 해소: 두 방법의 trade-off 정리, 맥락 의존적 선택
